<div class="vc" style="padding: 2%;">
  <div class="hc" style="width: 100%; align-items: center; margin-bottom: 20px;">
    <div id="title" style="margin-right: 10px; padding-top: 10px; padding-bottom: 10px; color: var(--textPrimary); font-family: Special; font-size: 40px; line-height: 40px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">Themes</div>
    <div id="folder" class="button buttonEmoteText" style="width: 40px; min-width: 40px; height: 40px; min-height: 40px;">üìÅ</div>
  </div>

  <div class="hc" id="themesList" style="flex-wrap: wrap;">
  
  </div>
</div>

<script>
  //MODULE NAME CAN'T BE CHANGED FREELY (SETTINGS MODULE, TRAY & MAIN.HTML) üò°
  themesFolder = currentModule+'Themes\\'

  document.getElementById('windowBackground').style.overflowY = 'scroll'
  createThemeList()

  function createThemeList() {
    document.body.style.setProperty('--themeItemSize', '0')
    const themeResizeOb = new ResizeObserver(function(entries) {
      let i = 4
      while (document.getElementById('themesList').offsetWidth/i > 155) { i++ }
      document.body.style.setProperty('--themeItemSize', 100/i+'%')
    })
    themeResizeOb.observe(document.querySelector("#themesList"))

    if (!fs.existsSync(themesFolder)) return
    document.getElementById('themesList').innerHTML = ''
    //START
    let allPaths = fs.readdirSync(themesFolder)
    for(i in allPaths) {
      //DATA
      let id = 'theme'+i
      let name = allPaths[i]
      let path = themesFolder+name
      let icon = "./Data/Images/iconFile.png"
      let tmpicon = path+'\\Data\\Images\\iconFile.png'
      if (fs.existsSync(tmpicon)) icon = tmpicon
      //CREATE HTML
      let html = `<div id="${id}" class="button vc" style="width: calc(var(--themeItemSize) - 6px); aspect-ratio: 1/1; margin: 3px; position: relative;">
                    <div class="vc" style="height: 65%;">
                      <img style="height: 90%; aspect-ratio: 1/1; margin: 5% auto 0 auto; border-radius: var(--buttonCornerRadius); filter: drop-shadow(var(--shadow)); object-fit: contain;" src="${icon}"></img>
                    </div>
                    <div class="vc" style="height: 35%; align-items: center;">
                      <div style="width: 90%; margin: auto; text-align: center; font-size: 15px; line-height: 18px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; color: var(--textColor);">${name}</div>
                    </div>
                  </div>`
      document.getElementById('themesList').insertAdjacentHTML('beforeend', html)
      //ADD LISTENER
      addButtonListener(id, function() {
        document.getElementById('title').innerText = 'Loading: '+name
        $("#windowBackground").animate({ scrollTop: 0 }, "fast")
        ipcRenderer.send('pause')
        const fse = require('fs-extra')
        fse.copy(path, data.root, { overwrite: true }).then(function() {
          ipcRenderer.send('reloadAssistant')
          ipcRenderer.send('resume')
        }).catch(function() {
          document.getElementById('title').innerText = 'Error Loading: '+name
          ipcRenderer.send('resume')
        })
      })
    }
  }

  addButtonListener('folder', function() {
    ipcRenderer.send('showOnExplorer', currentModule+'Themes\\', false)
  })
</script>