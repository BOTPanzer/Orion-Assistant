<div class="vc" style="width: 100%;">
  <div class="hc" style="width: calc(100% - 40px); margin-top: 20px; padding-left: 20px; padding-right: 20px;">
    <div class="button" style="flex-grow: 1; margin-right: 10px;">
      <input id='nameText' class="input" type="text" spellcheck="false" placeholder="Name" maxlength="30" style="flex-grow: 1;"></input>
    </div>
    <img id="img" style="height: 40px; width: 40px;" src="Data/Images/iconFolder.png"></img>
  </div>

  <div class="vc" style="width: 100%; margin-top: 20px; align-items: center;">
    <div class="hc" style="gap: 10px;">
      <div id="move" class="button text" style="width: 130px; min-width: 130px; height: 40px; min-height: 40px; flex-direction: column;">Move</div>
      <div id="remove" class="button text" style="width: 130px; min-width: 130px; height: 40px; min-height: 40px; flex-direction: column;">Remove</div>
    </div>
    <div class="hc" style=" margin-top: 10px; padding-left: 20px; padding-right: 20px; align-items: center;">
      <div id="save" class="button text" style="width: 130px; min-width: 130px; height: 40px; min-height: 40px; flex-direction: column;">Save</div>
      <div id="log" style="margin-left: 20px; font-size: 15px; line-height: 15px; display: none; -webkit-line-clamp: 2; -webkit-box-orient: vertical; align-items: center; color: var(--textPrimary); font-family: Main;"></div>
    </div>
  </div>
</div>

<script>
  refreshData()
  let actualPath = json.actualPath
  //OTHER
  let folderPath = specialData.path
  let oldName = folderPath.substring(folderPath.lastIndexOf("\\")+1)

  document.getElementById('nameDisplay').innerText = 'Folder Properties'
  document.getElementById('nameText').value = oldName
  
  addButtonListener('move', function() {
    ipcRenderer.send('getFolder', actualPath, 'Choose a Folder', 'movePaths')
  })
  
  addButtonListener('remove', function() {
    let paths = [folderPath]
    showRemoveWindow(paths)
  })
  
  addButtonListener('save', function() {
    let newName = document.getElementById('nameText').value
    saveFolder(newName)
  })

  //MOVE FOLDER
  ipcRenderer.on('movePaths', (event, newFilePath) => {
    let paths = [folderPath]
    newFilePath = newFilePath+'\\'
    if (!newFilePath.includes(specialData.launcherFolder)) return

    //CHECK IF NEW FOLDER IS ALSO BEING MOVED
    let posibleToMove = true
    for (i in paths) {
      if (newFilePath.includes(paths[i]))
      posibleToMove = false
    }

    //IF NOT MOVE ヾ(•ω•`)o
    if (posibleToMove) for (i in paths) {
      let path = paths[i]
      if (fs.existsSync(path)) {
        let oldFilePath = path
        if (path.endsWith('\\')) oldFilePath = path.slice(0,-1)
        let name = oldFilePath.substring(oldFilePath.lastIndexOf('\\')+1)
        fs.rename(path, newFilePath+name, function(err) { if (i == paths.length-1) closeWindow(actualPath) })
      } else if (i == paths.length-1) closeWindow(actualPath)
    }
  })
  
  //SAVE FOLDER
  function saveFolder(newName) {
    if (newName == oldName) closeWindow()
    else if (newName == '') {
      document.getElementById('log').innerText = 'Name Is Necesary'
      document.getElementById('log').style.display = '-webkit-box'
    } else if (fs.existsSync(folderPath)) {
      let newFilePath = actualPath+newName
      if (fs.existsSync(newFilePath)) {
        document.getElementById('log').innerText = 'Folder Already Exists'
        document.getElementById('log').style.display = '-webkit-box'
      } else fs.rename(folderPath, newFilePath, function(err) { closeWindow(actualPath) })
    }
  }
</script>