<div class="vc" style="padding: 2%;">
  <div class="hc" style="width: 100%; align-items: center; margin-bottom: 20px;">
    <div id="title" style="padding-top: 10px; padding-bottom: 10px; color: var(--textPrimary); font-family: Special; font-size: 40px; line-height: 40px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">Old Recovery</div>
    <div id="recoverFolder" class="button" style="width: 40px; min-width: 40px; height: 40px; min-height: 40px; margin-left: 10px;">
      <svg class="svg" viewBox="0 0 24 24" style="fill: #f0bd23;">
        <path d="M21.0169 7.99175C21.4148 8.55833 20.9405 9.25 20.2482 9.25H3C2.44772 9.25 2 8.80228 2 8.25V6.42C2 3.98 3.98 2 6.42 2H8.74C10.37 2 10.88 2.53 11.53 3.4L12.93 5.26C13.24 5.67 13.28 5.72 13.86 5.72H16.65C18.4546 5.72 20.0516 6.61709 21.0169 7.99175Z"/>
        <path d="M20.9834 10.75C21.5343 10.75 21.9815 11.1957 21.9834 11.7466L22 16.6503C22 19.6003 19.6 22.0003 16.65 22.0003H7.35C4.4 22.0003 2 19.6003 2 16.6503V11.7503C2 11.198 2.44771 10.7503 2.99999 10.7503L20.9834 10.75Z"/>
      </svg>
    </div>
  </div>

  <div class="vc" style="width: 100%; align-items: center; line-height: normal;">
    <div style="font-size: 100px; margin-top: 20px;">ðŸ™ˆ</div>
    <div style="font-size: 15px; color: var(--textPrimary);">Recover From the Folder Button</div>
  </div>
</div>

<script>
  //MODULE NAME NOT USED ANYWHERE ðŸ˜Ž
  addButtonListener('recoverFolder', function() {
    ipcRenderer.send('getFolder', '', '', 'recoveryFolder')
  })
  
  ipcRenderer.on('recoveryFolder', (event, oldpaths) => {
    if (oldpaths == '') return
    if (!fs.existsSync(oldpaths)) return
    var recursive = require("recursive-readdir")
    recursive(oldpaths, function (err, files) {
      for (i in files) {
        let file = files[i]
        if (!file.endsWith('.txt')) return
        let newFile = data.modules+'Library\\Library'+file.substring(oldpaths.length)
        if (newFile.includes('.')) newFile = newFile.substring(0, newFile.lastIndexOf('.'))
        newFile = newFile+'.json'
        //RESTORE OLD GAME
        let si = fs.readFileSync(file).toString().trim().split('\n')
        let path = si[0]
        if (path == undefined) path = ''
        let icon = si[1]
        if (icon == undefined) icon = ''
        //CREATE FOLDER IN CASE IT DOESN'T EXIST
        let folder = newFile.substring(0, newFile.lastIndexOf('\\'))
        if (!fs.existsSync(folder))
          fs.mkdirSync(folder)
        //CREATE GAME
        let fdata = {}
        fdata.path = path
        fdata.icon = icon
        fs.writeFileSync(newFile, JSON.stringify(fdata))
      }
      oCreateNoti('Recovery', 'Recovery Finished')
    })
  })
</script>